# 2026-02-11 작업 기록

## 요약
- **하이브리드 추천 시스템 구현**: 벡터 검색(1단계) + LLM 리랭킹(2단계)
- **부정적 선호 필터링 검증**: 쿠팡, 정치 관련 기사 완벽 제외
- **LLM 프롬프트 최적화**: 토큰 절약을 위한 Link+Keyword 방식 도입
- **태깅 비교**: KeyBERT vs GLiNER 전체 텍스트 분석 비교 완료

---

## 작업 1: 하이브리드 추천 시스템 구현

### 무엇을
- 벡터 유사도 기반의 1차 필터링과 Gemini 기반의 2차 정밀 랭킹을 결합한 추천 시스템 구축.

### 어떻게
- **1단계 (Vector)**: ChromaDB를 사용하여 페르소나의 Interest Group(Tech, Career, Economy)과 유사한 기사 50개 추출. 부정적 키워드 포함 시 점수 페널티 부여.
- **2단계 (LLM Reranking)**: Gemini-3-Flash 모델에 `Rank, Title, URL, Keywords`만 전달하여 페르소나의 문장형 취향에 맞춰 재정렬.
- **최적화**: API Rate Limit(429) 해결을 위해 배치 사이즈를 20개로 조정하고, 불필요한 요약문(Summary) 제거.

### 왜
- 단순 벡터 검색만으로는 "커리어 개발에 도움이 되는", "경제 트렌드를 읽는" 등 미묘한 뉘앙스를 반영하기 어려움.
- LLM을 통해 문맥적 적합성을 판단하여 추천 품질 향상.

### 결과
- **랭킹 변화 검증**:
    - "소프트웨어 종말론은 과도" (Vector 13위 → **Final 4위**) : 커리어 관심사 반영
    - "美 헤드헌팅 역채용" (Vector 20위 → **Final 5위**) : 구직/커리어 관심사 반영
    - "배당소득 분리과세" (Vector 40위 → **Final 8위**) : 경제 트렌드 관심사 반영
- **파일**: `core/recommendation.py` 수정

---

## 작업 2: 부정적 선호(Negative Preferences) 필터링

### 무엇을
- 사용자가 기피하는 특정 키워드(쿠팡) 및 주제(정치 가십, 의대 증원)를 추천에서 배제.

### 어떻게
- **Persona 파일 확장**: `persona_20s.md`에 `## Negative Keywords`와 `## Negative Sentences` 섹션 추가.
- **로직 구현**: 벡터 검색 시 해당 키워드가 포함된 문서의 유사도 점수에서 `-0.3` 페널티 적용.
- **프롬프트 강화**: LLM에게 "User Negative Sentences (AVOID these topics)" 섹션을 명시적으로 전달.

### 왜
- 사용자의 피로도를 높이는 원치 않는 뉴스를 차단하여 만족도 제고.

### 결과
- 2026.02.11일자 주요 뉴스인 "쿠팡" 관련 기사가 Top 20 추천 목록에서 **0건**으로 확인됨. (소스 데이터에는 다수 존재)

---

## 작업 3: 전체 텍스트 태깅 비교 (KeyBERT vs GLiNER)

### 무엇을
- 뉴스 기사 전문(Full Text)을 대상으로 한 태그 추출 성능 비교.

### 어떻게
- `core/compare_tags_full.py` 작성 및 실행.
- 동일 기사에 대해 KeyBERT와 GLiNER를 각각 적용하여 결과 JSON 생성.

### 왜
- 추천 시스템의 정확도를 높이기 위한 최적의 태깅 전략 수립.

### 결과
- **KeyBERT**: 주제(Topic) 파악에 강점 (예: '인공지능', '투자'). 넓은 범위의 매칭에 유리.
- **GLiNER**: 고유명사(Entity) 인식에 강점 (예: '샘 올트먼', '오픈AI'). 특정 대상 필터링에 유리.
- **결론**: 현재 시스템은 KeyBERT를 메인으로 사용하되, 향후 GLiNER를 보조적으로 활용(Entity Boosting)하기로 결정.
